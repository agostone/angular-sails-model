"use strict";var an=an||{};an.sails=an.sails||{},an.sails.model=an.sails.model||{},function(){var a={};a.find=function(a,b,c){io.socket.get(a,b,c)},a.insert=function(a,b,c){io.socket.post(a,b,c)},a.update=function(a,b,c){a+="/"+b.id,io.socket.put(a,b,c)},a.delete=function(a,b,c){io.socket.delete(a,b,c)},an.sails.model.Restful=a}();var an=an||{};an.sails=an.sails||{},an.sails.model=an.sails.model||{},function(){var a={};a.find=function(a,b,c){io.socket.get(a,b,c)},a.insert=function(a,b,c){a+="create",io.socket.get(a,b,c)},a.update=function(a,b,c){a+="update/"+b.id,io.socket.get(a,b,c)},a.delete=function(a,b,c){a+="destroy",io.socket.get(a,b,c)},an.sails.model.Shortcut=a}();var an=an||{};an.sails=an.sails||{},an.sails.model=an.sails.model||{},function(){function a(c){Object.defineProperty(this,"name",{enumerable:!1,get:function(){return a.getName(this.url)}}),Object.defineProperty(this,"url",{enumerable:!1,writable:!1,value:b(c)})}function b(a){return a=a.split("/"),""!==a[0]&&(a=[""].concat(a)),""===a[a.length-1]&&a.pop(),a.join("/")}function c(a,b){var c=this;return b instanceof Array?b.forEach(function(b,d,e){e[d]=new c(a).setData(b)}):b=new c(a).setData(b),b}function d(a,b,d){function e(e){switch(b.verb){case"create":e(c.call(i,a,b.data),d);break;case"update":e(c.call(i,a,b.data),d);break;case"destroy":e(c.call(i,a,b.previous),d)}}var g=["all",b.verb],h=g.length,i=this;do f[a][g[h]]&&f[a][g[h]].forEach(e);while(h--)}var e=an.sails.model.Restful,f={};a.setMethod=function(a){a=a.charAt(0).toUpperCase()+a.toLowerCase().substr(1),e=an.sails.model[a]||an.sails.model.Restful},a.find=function(a,g,h,i){var j=this;a=b(a),e.find(a,g,function(b,e){e.statusCode>=400&&e.statusCode<600?i(e):(b=c.call(j,a,b),void 0===f[a]&&(f[a]=[],io.socket.on(a,function(b,c){d.call(j,a,b,c)})),h(b))})},a.getName=function(a){var c=b(a).split("/");return c[c.length-1]},a.createFromObject=function(a,b){for(var c in this.prototype)a[c]=this.prototype[c];return Object.defineProperty(a,"virtualModel",{enumerable:!1,configurable:!1,writable:!1,value:!0}),this.prototype.constructor.apply(a,[b]),a},a.isModel=function(b){return b instanceof a||b.virtualModel===!0},a.on=function(a,b,c){return c=c||"all",f[a]=f[a]||{},void 0===f[a][c]&&(f[a][c]=[]),-1===f[a][c].indexOf(b)&&f[a][c].push(b),this},a.off=function(a,b,c){if(c=c||"all",f[a]&&f[a][c]){var d=f[a][c].indexOf(b);d>-1&&f[a][c].splice(d,1)}return this},a.prototype.save=function(a,b){var c=this,d="update";this.id||(d="insert"),e[d](this.url,this.getData(),function(d,e){e.statusCode>=400&&e.statusCode<600?b(e):(c.setData(d),a(c))})},a.prototype.setData=function(a){for(var b in a)a[b]instanceof Function||(this[b]=a[b]);return this},a.prototype.getData=function(){var a={};for(var b in this)this[b]instanceof Function||(a[b]=this[b]);return a},a.prototype.delete=function(a,b){var c=this;return this.id?e.delete(this.url,this.getData(),function(d,e){e.statusCode>=400&&e.statusCode<600?b(e):(c.id=void 0,a(c))}):a(this),this},an.sails.Model=a}();var an=an||{};an.angular=an.angular||{},an.angular.sails=an.angular.sails||{},angular.injector(["ng"]).invoke(function(a){function b(a){c.call(this,a)}var c=an.sails.Model;b.prototype=Object.create(c.prototype),b.setMethod=c.setMethod,b.find=c.find,b.getName=c.getName,b.createFromObject=c.createFromObject,b.isModel=c.isModel,b.on=c.on,b.off=c.off,b.prototype.save=function(){var b=a.defer();return c.prototype.save.call(this,function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},b.prototype.delete=function(){var b=a.defer();return c.prototype.delete.call(this,function(a){b.resolve(a)},function(a){b.reject(a)}),b.promise},an.angular.sails.Model=b});var anSailsModule;try{anSailsModule=angular.module("anSailsModule")}catch(error){anSailsModule=angular.module("anSailsModule",[])}anSailsModule.factory("anSailsModel",["$q","$rootScope",function(a,b){function c(a,b){return a.filter(function(a){return-1===b.indexOf(a)})}function d(d,e,f,g){function h(a,c,d){"perModel"===p&&(a=c.name+a.charAt(0).toUpperCase()+a.substr(1)),b.$broadcast(a,{model:c,data:d,scope:e.$id})}function i(a){var b=null;return e[m].every(function(c,d){return c.id===a.id?(b=d,!1):!0}),b}function j(a){e.$watchCollection(a,function(a){q&&a.save().then(function(b){h("sailsModelSaveSucceed",a,b)},function(b){h("sailsModelSaveFailed",a,b)})})}function k(a){e.$watchCollection(a,function(a,b){a=a||[],b=b||[];var d=c(a,b),e=c(b,a);e.forEach(function(a){void 0!==a.id&&a.delete().then(function(b){h("sailsModelDeleteSucceed",a,b)},function(b){h("sailsModelDeleteFailed",a,b)})}),d.forEach(function(a){void 0===a.id&&a.save().then(function(b){h("sailsModelSaveSucceed",a,b)},function(b){h("sailsModelSaveFailed",a,b)})})})}function l(a,b){var c;switch(a){case"create":angular.isArray(e[m])&&(e[m].push(b),e.$apply());break;case"update":angular.isArray(e[m])?(c=i(b),c>-1&&(e[m][c]=b,e.$apply())):(e[m]=b,e.$apply());break;case"destroy":angular.isArray(e[m])?(c=i(b),c>-1&&(delete e[m][c],e.$apply())):(delete e[m],e.$apply())}}g=g||{};var m;d instanceof Array&&(m=d[1],d=d[0]);var n=new a.defer,o=g.model||an.angular.sails.Model,p=g.eventModel||"perModel",q=g.autoPersist||!1,r=g.autoListen||!1;return m=m||o.getName(d),o.find(d,f,function(a){e[m]=a,e.$apply(),angular.isArray(a)?k(m):j(m),r&&(o.on(d,l),e.$on("$destroy",function(){o.off(d,l)})),n.resolve(a)},function(a){n.reject(a)}),n.promise}return{bind:d}}]);